# Express中Session的优化

在使用node.js做WEB开发中，[`express`](http://expressjs.com/)因为简单易用，插件丰富而大受开发者的欢迎，但也因为简单很多开发者在使用的时候没有深入考虑中间件应该在什么场合使用，直接把中间件往全局处理`app.use`一加就完事了。

最近接手了一个老旧的node.js项目，主要是基于express开发的，越来越多用户反馈响应速度越来越慢，产品要求对系统做一次优化。接手之后首先做的就是把各类的性能统计加上（没有性能统计做出来的优化都是纸老虎），收集一个星期的数据之后，性能的确是不咋的。而分析统计结果发现，读取`session`是程序中出现最多的，而在访问量大的时候，读取时间会达到`1s`，那么首先着手优化的点就是`session`的处理，该项目中所有的请求都会经过`session`的处理，而统计出来的结果，只有`30%`不到的请求是需要用到`session`的，而这些请求，又只有`20%`不到的请求是需要写`session`的。

## 处理流程
